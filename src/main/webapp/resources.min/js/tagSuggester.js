"use strict";function initTags(){""!==tags.tagInput.value&&(tags.tagLabel.style.top="-18px",tags.tagLabel.style.fontSize="12px"),tags.tagInput.addEventListener("focus",function(t){""===tags.tagInput.value&&upPlaceholder(),tags.tagView.style.display="block"}),tags.tagInput.addEventListener("blur",function(t){""===tags.tagInput.value&&downPlaceholder(),tags.closeTagViewTimer=setTimeout(function(){tags.tagView.style.display="none"},200)}),tags.tagInput.addEventListener("keydown",onTagInputStart),tags.tagInput.addEventListener("keyup",onTagInputEnd)}window.tags={tagsInputContainer:document.querySelector(".tags .tags-input"),tagInput:document.querySelector(".tags .tags-input input"),tagView:document.querySelector(".tags .tags-view"),tagLabel:document.querySelector(".tags .name"),loadTimer:void 0,cache:{},words:{},tagsCount:{},closeTagViewTimer:void 0};let removeFromEmpty=!1;function onTagInputStart(t){removeFromEmpty=tags.tagInput.value.length<1}function onTagInputEnd(t){const e=tags.tagInput.value;if(clearInterval(tags.loadTimer),"Backspace"===t.key&&e.length<1&&removeFromEmpty){let t=tags.tagsInputContainer.querySelector(".selected-tag:last-of-type");null!=t&&(delete tags.tagsCount[t.getAttribute("content")],tags.tagsInputContainer.removeChild(t))}else e.trim().length<1||(tags.words[e]?showTags(e):tags.loadTimer=setTimeout(function(){xhr.request({method:"GET",path:"/services/tags/small?q="+e},function(t,a){if(t){let a=JSON.parse(t);tags.words[e]=[];for(let t=0;t<a.length;t++){let n=a[t];tags.words[e].push(n.id),tags.cache[n.id]=n}showTags(e)}})},500))}function upPlaceholder(){if(tags.tagLabel.style.top.replace("px","")<0)return;let t=17;const e=setInterval(function(){t>-18?(tags.tagLabel.style.top=t+"px",tags.tagLabel.style.fontSize=12-t/25+"px",t-=5):clearInterval(e)},30)}function downPlaceholder(){if(Object.keys(tags.tagsCount).length>0)return;let t=-18;const e=setInterval(function(){t<17?(tags.tagLabel.style.top=t+"px",tags.tagLabel.style.fontSize=15-t/25+"px",t+=5):clearInterval(e)},30)}function showTags(t){if(tags.tagView.getAttribute("content")===t)return;let e=tags.words[t];tags.tagView.innerHTML="";for(let t=0;t<e.length;t++){let a=tags.cache[e[t]],n=document.createElement("div");n.classList.add("chip","chip-suggest"),n.style.background=a.color,n.setAttribute("content",a.id),n.addEventListener("click",clickTag),n.innerText=a.name,tags.tagView.appendChild(n)}}function clickTag(t){let e=t.currentTarget,a=e.cloneNode(!0),n=e.getAttribute("content");clearTimeout(tags.closeTagViewTimer),a.classList.add("selected-tag"),a.addEventListener("click",deleteTagOnClick),Object.keys(tags.tagsCount).length<5&&void 0===tags.tagsCount[n]&&(tags.tagsCount[n]=1,tags.tagsInputContainer.insertBefore(a,tags.tagInput),tags.tagInput.value="")}function deleteTagOnClick(t){delete tags.tagsCount[t.currentTarget.getAttribute("content")],tags.tagsInputContainer.removeChild(t.currentTarget)}